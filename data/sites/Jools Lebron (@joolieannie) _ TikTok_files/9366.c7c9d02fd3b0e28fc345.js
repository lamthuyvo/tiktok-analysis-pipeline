"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[9366],{59695:(e,t,n)=>{n.d(t,{Nj:()=>O,R8:()=>_,Sw:()=>b,b3:()=>h,tg:()=>f,xr:()=>I});var i=n(40099),s=n(11060),a=n(50453),l=n(52964),o=n(17141),c=n(61059),r=n(50978),d=n(19572),u=n(44529),y=n(76068),v=n(18360),g=n(47218),p=function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function l(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}c((i=i.apply(e,t||[])).next())}))};function f(){const{language:e,abTestVersion:t,user:n,appType:c}=(0,a.L)((0,l.W)((()=>["language","abTestVersion","user","appType"]),[])),{uniqueId:r}=(0,s.g)();return(0,i.useMemo)((()=>Object.assign({language:e,abTestVersion:t,user:n,appType:c},(0,o.b_)(r))),[r,e,t,n,c])}function h({uniqueId:e,secUid:t}){const{user:n}=(0,a.L)((0,l.W)((()=>["user"]),[]));return!!n&&(Boolean(e&&e===n.uniqueId)||Boolean(t&&t===n.secUid))}function b({user:e,listKey:t,locateItemID:n,count:s}){const a=(0,u.Ag)();return(0,i.useCallback)((()=>p(this,void 0,void 0,(function*(){var i;yield a.getItemList(t,Object.assign(Object.assign({secUid:null!==(i=null==e?void 0:e.secUid)&&void 0!==i?i:""},n&&{locateItemID:n}),s&&{count:s}))}))),[a,t,null==e?void 0:e.secUid,n,s])}const O=()=>{const e=(0,y.R0)((e=>e.uniqueId)),{pathname:t,search:n}=(0,s.zy)();(0,i.useEffect)((()=>{const i=t.replace(/^\/@/,"");if(e&&!(0,c.$2s)(i)){const t=`${(0,c.fJR)({uniqueId:e})}${n}`;window.history.replaceState(window.history.state,"",t)}}),[e,t])},I=()=>{var e;const{justWatchedVideo:t=null}=(0,v.MY)(),n=null!==(e=null==t?void 0:t.id)&&void 0!==e?e:"",i=(0,a.L)((0,r.F3)((e=>e[n]),g.bN,[n]));if(!n)return{justWatchedVideoId:null,justWatchedAuthorUniqueId:null,justWatchedAuthorId:null};const{author:s=null,authorId:l=null}=(0,a.L)(i);return{justWatchedVideoId:n,justWatchedAuthorUniqueId:s,justWatchedAuthorId:l}},_=()=>{var e;const{abTestVersion:t}=(0,a.L)((0,l.W)((()=>["abTestVersion"]),[]));return{count:{v0:35,v1:28,v2:24,v3:20,v4:16,v5:12}[null!==(e=(0,d.qt)(t,"reduce_user_item_list"))&&void 0!==e?e:"v0"]}}},76068:(e,t,n)=>{n.d(t,{$4:()=>m,M_:()=>_,R0:()=>j,dF:()=>I});var i,s=n(15068),a=n(50453),l=n(5413),o=n(62209),c=n(63244),r=n(44529),d=n(61375),u=n(12669),y=n(41420),v=n(68407),g=n(52354),p=n(18499),f=n(56698),h=n(71111),b=n(76e3);!function(e){e.Initial="initial",e.CreatePlaylist="create_playlist",e.CreatePlaylistReady="create_playlist_ready"}(i||(i={}));const O=(0,f._)((0,h.atom)({uniqueId:void 0,statusCode:void 0,secUid:void 0,profileState:"initial"}),{rehydrationKey:"webapp.userPage"});O.debugLabel="userPageAtom";const{useAtomService:I,useServiceDispatchers:_,useServiceState:j,getStaticApi:m}=(0,b.i)(O,((e,t)=>({setUniqueId(e){t(O,(t=>Object.assign(Object.assign({},t),{uniqueId:e})))},setProfileState(e){t(O,(t=>Object.assign(Object.assign({},t),{profileState:e})))},resetUserPage(){(0,p.unstable_batchedUpdates)((()=>{t(O,(e=>Object.assign(Object.assign({},e),{uniqueId:void 0,secUid:void 0,statusCode:0,profileState:"initial"}))),(0,r.Ds)().resetAllLists(),(0,d.UO)().setUniqueId(void 0),(0,u.cF)().resetUserFollowInfo(),(0,y.MA)().resetData(),(0,s.getCollectionInfoStaticApi)().resetCollectionInfoList()}))},getUserInfo(n){var i,r,u,f,h,b,I,_,j;return b=this,I=void 0,j=function*(){const b=(0,d.UO)(),I=(0,v.Gp)(),{uniqueId:_,locateItemID:j}=n,{user:m}=(0,c.x)(),{uniqueId:P,secUid:L}=(0,a.L)(m);let U=e(v.p9).users[null!=_?_:""];try{let c;if(this.resetUserPage(),"number"!=typeof(null===(i=null==U?void 0:U.extraInfo)||void 0===i?void 0:i.statusCode)){const t=yield I.getUserDetail(n);U=e(v.p9).users[null!==(f=null===(u=null===(r=t.userInfo)||void 0===r?void 0:r.user)||void 0===u?void 0:u.uniqueId)&&void 0!==f?f:""],c=t.statusCode}(0,p.unstable_batchedUpdates)((()=>{t(O,(e=>Object.assign(Object.assign({},e),{statusCode:null!=c?c:e.statusCode,uniqueId:null==U?void 0:U.uniqueId,secUid:null==U?void 0:U.secUid}))),b.setUniqueId(null==U?void 0:U.uniqueId)}));const d=[];(null==U?void 0:U.id)&&(0===c||10222===c)&&(0,l.fU)()&&d.push((0,g.s5)().getItemList(Object.assign({secUid:null!==(h=U.secUid)&&void 0!==h?h:"",userId:U.id},j&&{locateItemID:j})));const _=Boolean(m)&&(Boolean(P&&P===(null==U?void 0:U.uniqueId))||Boolean(L&&L===(null==U?void 0:U.secUid))),{id:C="",secUid:S=""}=(0,a.L)(U);!_&&(null==U?void 0:U.privateAccount)||d.push((0,y.MA)().getVideoPlaylistData({uid:C,secUid:S,isReset:!0})),(0,o.Oi)()&&S&&!_&&d.push((0,s.getCollectionInfoStaticApi)().getCollectionInfoList({secUid:S,isReset:!0})),yield Promise.allSettled(d)}catch(e){console.error(e),t(O,(e=>Object.assign(Object.assign({},e),{statusCode:-1})))}},new((_=void 0)||(_=Promise))((function(e,t){function n(e){try{s(j.next(e))}catch(e){t(e)}}function i(e){try{s(j.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof _?s:new _((function(e){e(s)}))).then(n,i)}s((j=j.apply(b,I||[])).next())}))}})))},41420:(e,t,n)=>{n.d(t,{MA:()=>j,kn:()=>O,aD:()=>_,c8:()=>b});var i=n(65649),s=n(50453),a=n(56698),l=n(71111),o=n(76e3),c=n(52489),r=n(76031),d=n(68180),u=n(79490),y=n(52094),v=function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function l(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}c((i=i.apply(e,t||[])).next())}))};const g=(0,y.M)({csr:function(e){return v(this,void 0,void 0,(function*(){const t=(0,d.t$)("userPlayList");if(t)return t;const{uid:n}=e,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}(e,["uid"]);return u.hd.get("/api/user/playlist/",{query:i,baseUrlType:2})}))}});var p=function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function l(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}c((i=i.apply(e,t||[])).next())}))};const f="0",h={loading:!1,changeOrderLoading:!1,hasMore:!0,statusCode:0,playList:[],cursor:f},b=(0,a._)((0,l.atom)(h),{rehydrationKey:"webapp.videoPlaylist"});b.debugLabel="videoPlaylistSharedAtom";const{useAtomService:O,useServiceDispatchers:I,useServiceState:_,getStaticApi:j}=(0,o.i)(b,((e,t)=>({resetData(){t(b,h)},setPlaylist(e){const{statusCode:n,playList:i=[],hasMore:a,cursor:l,loading:o,changeOrderLoading:c,isMerge:r=!1}=(0,s.L)(e);t(b,(e=>{var t;return Object.assign(Object.assign({},e),{statusCode:null!=n?n:e.statusCode,hasMore:null!=a?a:e.hasMore,cursor:null!=l?l:e.cursor,playList:r?[...null!==(t=e.playList)&&void 0!==t?t:[],...i]:i,loading:null!=o?o:e.loading,changeOrderLoading:null!=c?c:e.changeOrderLoading})}))},changePlaylistOrder(n){return p(this,void 0,void 0,(function*(){const{playlist:s=[],endIndex:a=-1,successCallback:l}=n,{playList:o=[]}=e(b),c=s.slice(0,a+1);if(!c.length)return 0;let d;t(b,(e=>Object.assign(Object.assign({},e),{changeOrderLoading:!0})));try{({statusCode:d}=yield function(e){var t;return v(this,void 0,void 0,(function*(){return u.hd.post("/api/playlist/modify_order/",{baseUrlType:2,body:r.stringify({commitMixIds:null!==(t=e.commitMixIds)&&void 0!==t?t:""})})}))}({commitMixIds:c.join(",")}))}catch(e){d=-1}try{if(i.c.handleSaveChangePlaylistOrder({status:0===d?"1":"0"}),0!==d)return t(b,(e=>Object.assign(Object.assign({},e),{changeOrderLoading:!1}))),d;const e=[...c,...o.slice(a+1)];return null==l||l(),this.setPlaylist({playList:e,changeOrderLoading:!1}),d}catch(e){return console.error(e),t(b,(e=>Object.assign(Object.assign({},e),{changeOrderLoading:!1}))),-1}}))},getVideoPlaylistData(n){return p(this,void 0,void 0,(function*(){const{uid:i,secUid:s,isReset:a}=n,{cursor:l=f,hasMore:o}=e(b);if(!o)return;const r=a?f:l;let d;t(b,(e=>Object.assign(Object.assign({},e),{loading:!0})));try{d=yield g({uid:i,secUid:s,cursor:r,count:20})}catch(e){d={statusCode:-1,playList:[],hasMore:o}}try{const{playList:e=[]}=d,t=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}(d,["playList"]),n=e.filter((({id:e})=>e)),i=n.map((({id:e})=>e));(0,c.iy)().multiSetPlaylistItem(n),this.setPlaylist(Object.assign(Object.assign({},t),{playList:i,isMerge:!a,loading:!1}))}catch(e){console.error(e),t(b,(e=>Object.assign(Object.assign({},e),{loading:!1})))}}))}})))},52489:(e,t,n)=>{n.d(t,{cw:()=>r,iy:()=>d,qi:()=>o});var i=n(56698),s=n(71111),a=n(76e3);const l=(0,i._)((0,s.atom)({}),{rehydrationKey:"webapp.videoPlaylistItems"});l.debugLabel="playlistItemAtom";const{useAtomService:o,useServiceDispatchers:c,useServiceState:r,getStaticApi:d}=(0,a.i)(l,((e,t)=>({multiSetPlaylistItem(n){const i=e(l),s={};n.forEach((e=>{var t;const{id:n=""}=e,a=null!==(t=i[n])&&void 0!==t?t:{};s[n]=Object.assign(Object.assign({},a),e)})),t(l,Object.assign(Object.assign({},i),s))},setPlaylistItem(e){const{id:n=""}=e;t(l,(t=>Object.assign(Object.assign({},t),{[n]:Object.assign(Object.assign({},t[n]),e)})))}})))},33797:(e,t,n)=>{n.d(t,{$D:()=>l});var i=n(73580),s=n(40099),a=n(29238);function l(e){const t=(0,i.Nj)(a.JX);(0,s.useEffect)((()=>{t.setPreloadQueue(e)}),[e,t])}},740:(e,t,n)=>{n.d(t,{xB:()=>a});var i=n(40099),s=n(39154);function a(e){(0,i.useEffect)((()=>{let t=[];e&&(t=e.map((e=>e.id))),s._.updateIds(t)}),[e])}},65649:(e,t,n)=>{n.d(t,{c:()=>s});var i=n(24642);const s={handleCreatePlaylist:()=>{i.f.sendEvent("create_playlist")},handleClickAddPlaylistVideo:e=>{i.f.sendEvent("click_add_playlist_video",e)},handleAddPlaylistVideo:e=>{i.f.sendEvent("add_playlist_video",e)},handlePostCreatingPlaylist:e=>{i.f.sendEvent("post_creating_playlist",e)},handleClickChangePlaylistOrder:()=>{i.f.sendEvent("click_change_playlist_order")},handleSaveChangePlaylistOrder:e=>{i.f.sendEvent("save_change_playlist_order",e)},handleCompleteEditingPlaylist:e=>{i.f.sendEvent("complete_editing_playlist",e)},handleClickPlaylistEntrance:e=>{i.f.sendEvent("click_playlist_entrance",e)},handleClickRenamePlaylist:e=>{i.f.sendEvent("click_rename_playlist",e)},handleClickDeletePlaylist:e=>{i.f.sendEvent("click_delete_playlist",e)},handleDeletePlaylist:e=>{i.f.sendEvent("delete_playlist",e)},handleClickRemovePlaylistVideo:e=>{i.f.sendEvent("click_remove_playlist_video",e)},handleRemovePlaylistVideo:e=>{i.f.sendEvent("remove_playlist_video",e)}}}}]);